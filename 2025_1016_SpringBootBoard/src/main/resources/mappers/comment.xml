<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.db4.dao.CommentDao">
	

<!-- b_idx 게시글에 대한 댓글정보 -->

	<select id="selectList" parameterType="map" resultType="CommentVo">
		select * from
		(select
			*,
			rank() over(order by c_idx desc) as no
		from comment_tb where b_idx=#{b_idx}
		) c
		where no between #{start} and #{end}
	</select> 
	
	<!-- b_idx에 대한 댓글 갯수 -->
	<select id="selectRowTotal" parameterType="int">
		select ifnull(count(*),0) from comment_tb
		where b_idx=#{b_idx}
	</select>
	
<!-- 댓글 등록 -->
	
	<insert id="comment_insert" parameterType="CommentVO">
		insert into comment_tb values(
										null
									   ,#{c_content}
									   ,#{c_ip}
									   ,now()
									   ,#{b_idx}
									   ,#{mem_idx}
									   ,#{mem_id}
		)
	</insert>
	
	<!-- 삭제 -->
	<delete id="comment_delete" parameterType="int">
		delete from comment_tb where c_idx=#{c_idx}
	
	</delete>

</mapper>












